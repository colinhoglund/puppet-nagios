#
class nagios::config::main (
  $log_file                                    = $nagios::params::log_file,
  $object_cache_file                           = $nagios::params::object_cache_file,
  $precached_object_file                       = $nagios::params::precached_object_file,
  $resource_file                               = $nagios::params::resource_file,
  $status_file                                 = $nagios::params::status_file,
  $status_update_interval                      = '10',
  $nagios_user                                 = 'nagios',
  $nagios_group                                = 'nagios',
  $check_external_commands                     = '1',
  $command_check_interval                      = '-1',
  $command_file                                = $nagios::params::command_file,
  $external_command_buffer_slots               = '4096',
  $lock_file                                   = $nagios::params::lock_file,
  $temp_file                                   = $nagios::params::temp_file,
  $temp_path                                   = '/tmp',
  $event_broker_options                        = '-1',
  $broker_module                               = undef,
  $log_rotation_method                         = 'd',
  $log_archive_path                            = $nagios::params::log_archive_path,
  $use_syslog                                  = '1',
  $log_notifications                           = '1',
  $log_service_retries                         = '1',
  $log_host_retries                            = '1',
  $log_event_handlers                          = '1',
  $log_initial_states                          = '0',
  $log_external_commands                       = '1',
  $log_passive_checks                          = '1',
  $global_host_event_handler                   = undef,
  $global_service_event_handler                = undef,
  $service_inter_check_delay_method            = 's',
  $max_service_check_spread                    = '30',
  $service_interleave_factor                   = 's',
  $host_inter_check_delay_method               = 's',
  $max_host_check_spread                       = '30',
  $max_concurrent_checks                       = '0',
  $check_result_reaper_frequency               = '10',
  $max_check_result_reaper_time                = '30',
  $check_result_path                           = $nagios::params::check_result_path,
  $max_check_result_file_age                   = '3600',
  $cached_host_check_horizon                   = '15',
  $cached_service_check_horizon                = '15',
  $enable_predictive_host_dependency_checks    = '1',
  $enable_predictive_service_dependency_checks = '1',
  $soft_state_dependencies                     = '0',
  $time_change_threshold                       = undef,
  $auto_reschedule_checks                      = '0',
  $auto_rescheduling_interval                  = '30',
  $auto_rescheduling_window                    = '180',
  $sleep_time                                  = '0.25',
  $service_check_timeout                       = '60',
  $host_check_timeout                          = '30',
  $event_handler_timeout                       = '30',
  $notification_timeout                        = '30',
  $ocsp_timeout                                = '5',
  $perfdata_timeout                            = '5',
  $retain_state_information                    = '1',
  $state_retention_file                        = $nagios::params::state_retention_file,
  $retention_update_interval                   = '60',
  $use_retained_program_state                  = '1',
  $use_retained_scheduling_info                = '1',
  $retained_host_attribute_mask                = '0',
  $retained_service_attribute_mask             = '0',
  $retained_process_host_attribute_mask        = '0',
  $retained_process_service_attribute_mask     = '0',
  $retained_contact_host_attribute_mask        = '0',
  $retained_contact_service_attribute_mask     = '0',
  $interval_length                             = '60',
  $check_for_updates                           = '1',
  $bare_update_check                           = '0',
  $use_aggressive_host_checking                = '0',
  $execute_service_checks                      = '1',
  $accept_passive_service_checks               = '1',
  $execute_host_checks                         = '1',
  $accept_passive_host_checks                  = '1',
  $enable_notifications                        = '1',
  $enable_event_handlers                       = '1',
  $process_performance_data                    = '0',
  $host_perfdata_command                       = undef,
  $service_perfdata_command                    = undef,
  $host_perfdata_file                          = undef,
  $service_perfdata_file                       = undef,
  $host_perfdata_file_template                 = undef,
  $service_perfdata_file_template              = undef,
  $host_perfdata_file_mode                     = undef,
  $service_perfdata_file_mode                  = undef,
  $host_perfdata_file_processing_interval      = undef,
  $service_perfdata_file_processing_interval   = undef,
  $host_perfdata_file_processing_command       = undef,
  $service_perfdata_file_processing_command    = undef,
  $host_perfdata_process_empty_results         = undef,
  $service_perfdata_process_empty_results      = undef,
  $obsess_over_services                        = '0',
  $ocsp_command                                = undef,
  $obsess_over_hosts                           = '0',
  $ochp_command                                = undef,
  $ochp_timeout                                = undef,
  $translate_passive_host_checks               = '0',
  $passive_host_checks_are_soft                = '0',
  $check_for_orphaned_services                 = '1',
  $check_for_orphaned_hosts                    = '1',
  $check_service_freshness                     = '1',
  $service_freshness_check_interval            = '60',
  $service_check_timeout_state                 = 'c',
  $check_host_freshness                        = '0',
  $host_freshness_check_interval               = '60',
  $additional_freshness_latency                = '15',
  $enable_flap_detection                       = '1',
  $low_service_flap_threshold                  = '5.0',
  $high_service_flap_threshold                 = '20.0',
  $low_host_flap_threshold                     = '5.0',
  $high_host_flap_threshold                    = '20.0',
  $date_format                                 = $nagios::params::date_format,
  $use_timezone                                = undef,
  $p1_file                                     = $nagios::params::p1_file,
  $enable_embedded_perl                        = '1',
  $use_embedded_perl_implicitly                = '1',
  $illegal_object_name_chars                   = '`~!$%^&*|\'"<>?,()=',
  $illegal_macro_output_chars                  = '`~$&|\'"<>',
  $use_regexp_matching                         = '0',
  $use_true_regexp_matching                    = '0',
  $admin_email                                 = 'nagios@localhost',
  $admin_pager                                 = 'pagenagios@localhost',
  $daemon_dumps_core                           = '0',
  $use_large_installation_tweaks               = '0',
  $enable_environment_macros                   = '1',
  $free_child_process_memory                   = undef,
  $child_processes_fork_twice                  = undef,
  $debug_level                                 = '0',
  $debug_verbosity                             = '1',
  $debug_file                                  = $nagios::params::debug_file,
  $max_debug_file_size                         = '1000000',
  $allow_empty_hostgroup_assignment            = undef,
){
  $cfg_dir = $nagios::cfg_dir

  require nagios::config

  file { $nagios::main_config_file:
    ensure  => file,
    owner   => 'root',
    group   => 'root',
    mode    => '0644',
    content => template("${module_name}/nagios.erb"),
    notify  => Service[$nagios::service_name],
  }
}
